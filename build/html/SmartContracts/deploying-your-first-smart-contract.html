

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Deploying Your First Smart Contract &mdash; Stratis Academy  documentation</title>
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">
  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Auction Smart Contract" href="auction-smart-contract.html" />
    <link rel="prev" title="Uses of Smart Contracts" href="uses-of-smart-contracts.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Stratis Academy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Blockchain101/blockchain101-introduction.html">     Blockchain 101 Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Wallets/wallet-introduction.html">     Wallets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FullNode/full-node-introduction.html">     Full Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICO/ico-introduction.html">     ICO Platform</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="smart-contracts-introduction.html">     Smart Contracts</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="smart-contracts-basic-theory.html">Basic Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="uses-of-smart-contracts.html">Uses of Smart Contracts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Deploying Your First Smart Contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#downloading-the-smart-contract-source">Downloading the smart contract source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-visual-studio-project-template">Installing the Visual Studio Project Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-smart-contracts-project">Creating a smart contracts project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validating-your-smart-contract">Validating your smart contract</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#more-about-the-sct">More about the SCT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#running-a-smart-contract-enabled-version-of-the-stratis-full-node">Running a smart contract enabled version of the Stratis full node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-the-funds-to-deploy-smart-contracts">Getting the funds to deploy smart contracts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-wallet">Creating a wallet</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-funds">Getting funds</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-the-auction-smart-contract">Deploying the auction smart contract</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specifying-smart-contract-constructor-parameters">Specifying smart contract constructor parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#placing-a-bid-on-the-auction-smart-contract">Placing a bid on the auction smart contract</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-the-bid-has-been-stored-on-the-test-network">Checking the bid has been stored on the test network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auction-smart-contract.html">The Auction Smart Contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="support-and-community.html">Support and Community</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix-future-enhancements-to-smart-contracts.html">Appendix - Future Enhancements to Stratis Smart Contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix-gas-prices.html">Appendix - Gas Prices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Sidechains/sidechains-introduction.html">     Sidechains</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Stratis Academy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="smart-contracts-introduction.html">Stratis Smart Contracts</a> &raquo;</li>
        
      <li>Deploying Your First Smart Contract</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/SmartContracts/deploying-your-first-smart-contract.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploying-your-first-smart-contract">
<h1>Deploying Your First Smart Contract<a class="headerlink" href="#deploying-your-first-smart-contract" title="Permalink to this headline">¶</a></h1>
<p>This chapter takes you through deploying a smart contract, which simulates an auction. The smart contract is provided as a Visual Studio Project Template. As part of the deployment process, the smart contract is validated to ensure it does not contain any non-deterministic elements. Once deployed, a bid is then placed on the auction to test that the smart contract was deployed correctly. The steps taken when deploying the smart contract are as follows:</p>
<ol class="arabic simple">
<li>Download or clone the source.</li>
<li>Installing the Visual Studio Project Template.</li>
<li>Create a smart contracts project, which will include an auction smart contract and unit tests.</li>
<li>Validate the smart contract with the smart contract tool (SCT).</li>
<li>Run the smart contract enabled version of the full node.</li>
<li>Get the funds to deploy the auction smart contract and place a bid.</li>
<li>Build and deploy the smart contract.</li>
<li>Place a bid.</li>
<li>Check the bid has been stored on the test network.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This chapter assumes a Windows development environment. Stratis smart contracts can be developed on other platforms, and documentation to support this will be available soon.</p>
</div>
<div class="section" id="downloading-the-smart-contract-source">
<h2>Downloading the smart contract source<a class="headerlink" href="#downloading-the-smart-contract-source" title="Permalink to this headline">¶</a></h2>
<p>First, download a copy of <a class="reference external" href="https://www.visualstudio.com/downloads/">Microsoft Visual Studio</a> if you don’t have a copy already. This is the standard IDE for C# development and the Community Edition is available for free.</p>
<p>Next, make sure you have the latest .NET SDK installed. You can verify this by running <code class="docutils literal notranslate"><span class="pre">dotnet</span> <span class="pre">--version</span></code> on the command line. If you do not have the .NET SDK installed, download and install it from <a class="reference external" href="https://www.microsoft.com/net/learn/get-started/windows#install">here</a>.</p>
<p>Next, you must download or clone the <a class="reference external" href="https://github.com/stratisproject/StratisBitcoinFullNode/tree/sc-alpha">sc-alpha branch of the Stratis Smart Contract Enabled Full Node</a>. This repository contains everything you need to run a Stratis full node that can sync and mine on a Stratis smart contract network. It also contains the <code class="docutils literal notranslate"><span class="pre">sct</span></code> tool, which validates and deploys contracts.</p>
</div>
<div class="section" id="installing-the-visual-studio-project-template">
<h2>Installing the Visual Studio Project Template<a class="headerlink" href="#installing-the-visual-studio-project-template" title="Permalink to this headline">¶</a></h2>
<p>The Stratis smart contract Visual Studio Project Template provides an easy way to create a new smart contract project. It contains a template for a smart contract, unit tests, and references to appropriate NuGet packages.</p>
<p>The template can be <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=StratisGroupLtd.StratisSmartContractsTemplate">found on the Visual Studio marketplace</a>.</p>
</div>
<div class="section" id="creating-a-smart-contracts-project">
<h2>Creating a smart contracts project<a class="headerlink" href="#creating-a-smart-contracts-project" title="Permalink to this headline">¶</a></h2>
<p>To create a new smart contracts project, navigate to File &gt; New &gt; Project… and create a new ‘Stratis SmartContract Project’ under ‘Visual C#’. This generates a new solution containing Auction.cs and some sample unit tests. Notice that Auction.cs just contains a C# class called Auction. Later, you will explore the individual properties and methods on this class in detail.</p>
</div>
<div class="section" id="validating-your-smart-contract">
<h2>Validating your smart contract<a class="headerlink" href="#validating-your-smart-contract" title="Permalink to this headline">¶</a></h2>
<p>When you attempt to deploy a smart contract by including it in a transaction, it is tested to see if its C# code is correct and deterministic. Mining nodes carry out this testing before they include a smart contract transaction in a block. In addition, other nodes on the network attempt to validate any smart contracts that they find in any blocks they receive. If the smart contracts are not valid, the entire block is rejected. Therefore, you will want to know your smart contract meets the validation criteria before you try and deploy it. Stratis provides SCT (a command-line tool) for validating and building smart contracts.</p>
<p>The SCT tool is located within the source code of the full node that was cloned earlier. Navigate to this source code directory, and then change into the SCT project directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">src</span><span class="o">/</span><span class="n">Stratis</span><span class="o">.</span><span class="n">SmartContracts</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">Sct</span>
</pre></div>
</div>
<p>You are now going to validate the auction smart contract and request to see its byte code. When you begin writing your own smart contracts, you will also carry out this step for them before you deploy. Right click on your Auction.cs file tab in Visual Studio and click ‘Copy Path’. Then, back on the command line, use the <code class="docutils literal notranslate"><span class="pre">validate</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">run</span> <span class="o">--</span> <span class="n">validate</span> <span class="p">[</span><span class="n">PASTE_YOUR_PATH</span> <span class="n">HERE</span><span class="p">]</span> <span class="o">-</span><span class="n">sb</span>
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">======</span> <span class="n">Smart</span> <span class="n">Contract</span> <span class="n">Validation</span> <span class="n">results</span> <span class="k">for</span> <span class="n">file</span> <span class="p">[</span><span class="n">YOUR_FILE_PATH</span><span class="p">]</span> <span class="o">======</span>
<span class="n">Compilation</span> <span class="n">Result</span>
<span class="n">Compilation</span> <span class="n">OK</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">Format</span> <span class="n">Validation</span> <span class="n">Result</span>
<span class="n">Format</span> <span class="n">Valid</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">Determinism</span> <span class="n">Validation</span> <span class="n">Result</span>
<span class="n">Determinism</span> <span class="n">Valid</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">ByteCode</span>
<span class="mi">4</span><span class="n">D5A90000300000004000000F</span><span class="o">...</span>
</pre></div>
</div>
<p>Congratulations! You have compiled your first smart contract in C#. The bytecode is a hexadecimal representation of the .NET IL compiled for this contract and is all you need to deploy your contract on a network (provided you have a node running).</p>
<p>To further understand why this tool is important, go back to your contract and add this line in the constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">test</span> <span class="o">=</span> <span class="n">DateTime</span><span class="o">.</span><span class="n">Now</span><span class="p">;</span>
</pre></div>
</div>
<p>And this line at the top of the Auction.cs file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
</pre></div>
</div>
<p>So why is the first line problematic inside a smart contract? Different nodes are going to execute the code at different times and because of this, they all receive a different result for <code class="docutils literal notranslate"><span class="pre">DateTime.Now</span></code>. If this value was persisted in some way, all of the nodes would receive a different outcome for the contract state and would fail to reach a consensus.</p>
<p>Make sure you have saved Auction.cs and run the validation command again. SCT recognizes this non-deterministic call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">======</span> <span class="n">Smart</span> <span class="n">Contract</span> <span class="n">Validation</span> <span class="n">results</span> <span class="k">for</span> <span class="n">file</span> <span class="p">[</span><span class="n">YOUR_FILE_PATH</span><span class="p">]</span> <span class="o">======</span>
<span class="n">Compilation</span> <span class="n">Result</span>
<span class="n">Compilation</span> <span class="n">OK</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">Format</span> <span class="n">Validation</span> <span class="n">Result</span>
<span class="n">Format</span> <span class="n">Valid</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">Determinism</span> <span class="n">Validation</span> <span class="n">Result</span>
<span class="n">Determinism</span> <span class="n">Valid</span><span class="p">:</span> <span class="kc">False</span>

<span class="o">.</span><span class="n">ctor</span><span class="p">:</span>
   <span class="n">System</span><span class="o">.</span><span class="n">DateTime</span> <span class="n">System</span><span class="o">.</span><span class="n">DateTime</span><span class="p">::</span><span class="n">get_Now</span><span class="p">()</span> <span class="ow">is</span> <span class="n">non</span><span class="o">-</span><span class="n">deterministic</span><span class="o">.</span>
</pre></div>
</div>
<p>Now back out the non-deterministic code and resave.</p>
<div class="section" id="more-about-the-sct">
<h3>More about the SCT<a class="headerlink" href="#more-about-the-sct" title="Permalink to this headline">¶</a></h3>
<p>The SCT uses 3 commands:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>build</td>
<td>Builds a contract and outputs a dll. For testing purposes.</td>
</tr>
<tr class="row-odd"><td>deploy</td>
<td>Deploys a smart contract to the given node.</td>
</tr>
<tr class="row-even"><td>validate</td>
<td>Validates smart contracts for structure and determinism.</td>
</tr>
</tbody>
</table>
<p>The SCT provides further information on using these commands. For example, the following usage requests help on the validate command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">run</span> <span class="o">--</span> <span class="n">validate</span>  <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-a-smart-contract-enabled-version-of-the-stratis-full-node">
<h2>Running a smart contract enabled version of the Stratis full node<a class="headerlink" href="#running-a-smart-contract-enabled-version-of-the-stratis-full-node" title="Permalink to this headline">¶</a></h2>
<p>To interact with the smart contract test network, you now need to build the smart contract daemon. This is the Stratis.StratisSmartContractsD project in the <a class="reference external" href="https://github.com/stratisproject/StratisBitcoinFullNode/tree/sc-alpha">sc-alpha branch of the Stratis Smart Contract Enabled Full Node</a>, which you either downloaded or cloned. When the project is built, run the daemon as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">src</span><span class="o">/</span><span class="n">Stratis</span><span class="o">.</span><span class="n">StratisSmartContractsD</span>
<span class="n">dotnet</span> <span class="n">run</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">13.64</span><span class="o">.</span><span class="mf">119.220</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">20.190</span><span class="o">.</span><span class="mf">57.145</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">40.68</span><span class="o">.</span><span class="mf">165.12</span>
</pre></div>
</div>
<p>Adding the three nodes attempts to connect the daemon to the smart contract test network.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The smart contract test network is a testing environment and its uptime may fluctuate. For the most up-to-date information on the test network status, join us on Discord: <a class="reference internal" href="support-and-community.html#support-and-community"><span class="std std-ref">Support and Community</span></a>.</p>
</div>
</div>
<div class="section" id="getting-the-funds-to-deploy-smart-contracts">
<h2>Getting the funds to deploy smart contracts<a class="headerlink" href="#getting-the-funds-to-deploy-smart-contracts" title="Permalink to this headline">¶</a></h2>
<p>To deploy a smart contract you need funds to pay the transaction fees and the gas to run the smart contract. In this case, you are also going to test the smart contract out by placing a bid, which involves calling one of its methods. There is additional expenditure involved here because you must pay for:</p>
<ol class="arabic simple">
<li>The amount you are going to bid.</li>
<li>The transaction fees involved when making the bid (sending money to a deployed auction smart contract).</li>
<li>The gas to run the smart contract method.</li>
</ol>
<p>To get funds, you must first create a wallet and then request the funds. The next two subsections detail how to do this.</p>
<div class="section" id="creating-a-wallet">
<h3>Creating a wallet<a class="headerlink" href="#creating-a-wallet" title="Permalink to this headline">¶</a></h3>
<p>Because the smart contract API hasn’t been integrated with any GUI wallets yet, you must use the API directly via Swagger. Whilst your node is running, navigate to <a class="reference external" href="http://localhost:38220/swagger">http://localhost:38220/swagger</a>.</p>
<p>To create a wallet, navigate to the Wallet section and use the <cite>/api/Wallet/create</cite> call. You only need to specify a name and password in the request. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Satoshi&quot;</span><span class="p">,</span>
  <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You now have a wallet containing some TSTRAT addresses. To see the addresses, use the <cite>/api/Wallet/addresses</cite> call, which is also found in the Wallet section. You just need to specify your wallet name and an AccountName of “account 0”.</p>
</div>
<div class="section" id="getting-funds">
<h3>Getting funds<a class="headerlink" href="#getting-funds" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to get some TSTRAT is use the <a class="reference external" href="https://smartcontractsfaucet.stratisplatform.com/">smart contracts faucet</a>. To receive 100 TSTRAT, specify a TSTRAT address from your wallet. Make a note of the address you use. Use this TSTRAT address for deploying and testing the smart contract.</p>
<p>Alternatively, if you want to get more involved and earn some TSTRAT along the way, feel free to start mining! To begin mining, restart your node with an address from your wallet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">run</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">13.64</span><span class="o">.</span><span class="mf">119.220</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">20.190</span><span class="o">.</span><span class="mf">57.145</span> <span class="o">-</span><span class="n">addnode</span><span class="o">=</span><span class="mf">40.68</span><span class="o">.</span><span class="mf">165.12</span> <span class="o">-</span><span class="n">mine</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">mineaddress</span><span class="o">=</span><span class="p">[</span><span class="n">YOUR_WALLET_ADDRESS</span><span class="p">]</span>
</pre></div>
</div>
<p>Use the TSTRAT address you use for the mine address when deploying and testing the smart contract.</p>
</div>
</div>
<div class="section" id="deploying-the-auction-smart-contract">
<h2>Deploying the auction smart contract<a class="headerlink" href="#deploying-the-auction-smart-contract" title="Permalink to this headline">¶</a></h2>
<p>While you deploy your smart contract, it is important to remember that deploying a smart contract involves several steps:</p>
<ul class="simple">
<li>Compiling the contract.</li>
<li>Validating the contract.</li>
<li>Creating a transaction which contains the contract’s code.</li>
<li>Broadcasting the transaction to the network.</li>
</ul>
<p>From the command-line, you can use the <code class="docutils literal notranslate"><span class="pre">deploy</span></code> command to achieve all these steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">run</span> <span class="o">--</span> <span class="n">deploy</span> <span class="p">[</span><span class="n">PATH_TO_SMART_CONTRACT</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">38220</span> <span class="o">-</span><span class="n">wallet</span> <span class="p">[</span><span class="n">YOUR_WALLET_NAME</span><span class="p">]</span> <span class="o">-</span><span class="n">password</span> <span class="p">[</span><span class="n">YOUR_PASSWORD</span><span class="p">]</span> <span class="o">-</span><span class="n">fee</span> <span class="mf">0.002</span> <span class="o">-</span><span class="n">sender</span><span class="o">=</span><span class="p">[</span><span class="n">YOUR_WALLET_ADDRESS</span><span class="p">]</span> <span class="o">-</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">CONSTRUCTOR_PARAMS_IF_REQUIRED</span><span class="p">]</span>
</pre></div>
</div>
<p>As before, when you were validating the auction smart contract, you need to obtain the path to the Auction.cs file. However, because the Auction C# class contains a constructor parameter, <code class="docutils literal notranslate"><span class="pre">durationBlocks</span></code>, you must pass this value as well. The <code class="docutils literal notranslate"><span class="pre">durationBlocks</span></code> parameter specifies how many blocks are added to blockchain before the auction ends. In the following example, 20 blocks are added to the blockchain before the auction ends:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">run</span> <span class="o">--</span> <span class="n">deploy</span> <span class="n">PATH_TO_SMART_CONTRACT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">38220</span> <span class="o">-</span><span class="n">wallet</span> <span class="p">[</span><span class="n">YOUR_WALLET_NAME</span><span class="p">]</span> <span class="o">-</span><span class="n">password</span> <span class="p">[</span><span class="n">YOUR_PASSWORD</span><span class="p">]</span> <span class="o">-</span><span class="n">fee</span> <span class="mf">0.002</span> <span class="o">-</span><span class="n">sender</span><span class="o">=</span><span class="p">[</span><span class="n">YOUR_WALLET_ADDRESS</span><span class="p">]</span> <span class="o">--</span><span class="n">params</span> <span class="mi">10</span><span class="c1">#20</span>
</pre></div>
</div>
<p>A value of 20 is used because blocks are not confirmed until they are 5 blocks deep. Until the block which the smart contract is in has been confirmed, you cannot run the smart contract. You will notice that the value of 20 is preceeded by 10#. This information is part of the <code class="docutils literal notranslate"><span class="pre">durationBlocks</span></code> constructor parameter. More information on specifying constructor parameters is given in <a class="reference internal" href="#specifying-smart-contract-constructor-parameters">Specifying smart contract constructor parameters</a>.</p>
<p>When you deploy the smart contract, you should also check the block height. To do this, find the Consensus.Height in the Node Stats of the full node output. Keep checking the block height. After Consensus.Height has incremented by 5, you can be sure the smart contract has been deployed.</p>
<p>The tool returns the address of the contract if the contract was deployed successfully. Make sure you record this as you are going to use it when you place a bid.</p>
<div class="section" id="specifying-smart-contract-constructor-parameters">
<h3>Specifying smart contract constructor parameters<a class="headerlink" href="#specifying-smart-contract-constructor-parameters" title="Permalink to this headline">¶</a></h3>
<p>Smart contract parameters are serialized into a string. The format of each parameter is “{0}#{1}” where: {0} is an integer representing the Type of the serialized data and {1} is the serialized data itself. Serialized array values are separated by a dash <code class="docutils literal notranslate"><span class="pre">-</span></code> character.</p>
<p>Each parameter must be separated by the pipe <code class="docutils literal notranslate"><span class="pre">|</span></code> character.</p>
<p>Currently, only certain types of data can be serialized. Refer to the following table for the mapping between a type and its integer representation.</p>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">Param Type Serialization</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Integer representing
serialized type</th>
<th class="head">Serialize to string</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>System.Boolean</td>
<td>1</td>
<td>System.Boolean.ToString()</td>
</tr>
<tr class="row-odd"><td>System.Byte</td>
<td>2</td>
<td>System.Byte.ToString()</td>
</tr>
<tr class="row-even"><td>System.Byte[]</td>
<td>3</td>
<td>BitConverter.ToString()</td>
</tr>
<tr class="row-odd"><td>System.Char</td>
<td>4</td>
<td>System.Char.ToString()</td>
</tr>
<tr class="row-even"><td>System.SByte</td>
<td>5</td>
<td>System.SByte.ToString()</td>
</tr>
<tr class="row-odd"><td>System.Short</td>
<td>6</td>
<td>System.Short.ToString()</td>
</tr>
<tr class="row-even"><td>System.String</td>
<td>7</td>
<td>System.String</td>
</tr>
<tr class="row-odd"><td>System.UInt32</td>
<td>8</td>
<td>System.UInt32.ToString()</td>
</tr>
<tr class="row-even"><td>NBitcoin.UInt160</td>
<td>9</td>
<td>NBitcoin.UInt160.ToString()</td>
</tr>
<tr class="row-odd"><td>System.UInt64</td>
<td>10</td>
<td>System.UInt64.ToString()</td>
</tr>
<tr class="row-even"><td>Stratis.SmartContracts.Address</td>
<td>11</td>
<td>Stratis.SmartContracts.Address.ToString()</td>
</tr>
</tbody>
</table>
<p>As a further example, imagine a smart contract which has a constructor with the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="n">Token</span><span class="p">(</span><span class="n">ISmartContractState</span> <span class="n">state</span><span class="p">,</span> <span class="n">UInt160</span> <span class="n">owner</span><span class="p">,</span> <span class="n">UInt64</span> <span class="n">supply</span><span class="p">,</span> <span class="n">Byte</span><span class="p">[]</span> <span class="n">secretBytes</span><span class="p">)</span>
</pre></div>
</div>
<p>In addition to the mandatory ISmartContractState, there are 3 parameters which need to be supplied. Assuming they have these values:</p>
<ul class="simple">
<li>UInt160 owner = 0x95D34980095380851902ccd9A1Fb4C813C2cb639</li>
<li>UInt64 supply = 1000000</li>
<li>Byte[] secretBytes = { 0xAD, 0xBC, 0xCD }</li>
</ul>
<p>The serialized string representation of this data looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span><span class="c1">#0x95D34980095380851902ccd9A1Fb4C813C2cb639|10#1000000|3#AD-BC-CD</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="placing-a-bid-on-the-auction-smart-contract">
<h2>Placing a bid on the auction smart contract<a class="headerlink" href="#placing-a-bid-on-the-auction-smart-contract" title="Permalink to this headline">¶</a></h2>
<p>You can use Swagger to place a bid on the auction smart contract you have deployed. Navigate to the SmartContracts section and use <cite>/api/SmartContracts/build-and-send-call</cite>. For example, the following usage places a bid of 10 TSTRAT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;walletName&quot;</span><span class="p">:</span> <span class="s2">&quot;[YOUR_WALLET_NAME]&quot;</span><span class="p">,</span>
  <span class="s2">&quot;contractAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;[YOUR_CONTRACT_ADDRESS]&quot;</span><span class="p">,</span>
  <span class="s2">&quot;methodName&quot;</span><span class="p">:</span> <span class="s2">&quot;Bid&quot;</span><span class="p">,</span>
  <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
  <span class="s2">&quot;feeAmount&quot;</span><span class="p">:</span> <span class="s2">&quot;0.001&quot;</span><span class="p">,</span>
  <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;[YOUR_PASSWORD]&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;[YOUR_WALLET_ADDRESS]&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once you have placed the bid, you will need to wait for the Consensus.Height to be incremented by another 5 blocks. At this point the bid transaction is confirmed. Finally, you can check the bid is stored on the test network.</p>
</div>
<div class="section" id="checking-the-bid-has-been-stored-on-the-test-network">
<h2>Checking the bid has been stored on the test network<a class="headerlink" href="#checking-the-bid-has-been-stored-on-the-test-network" title="Permalink to this headline">¶</a></h2>
<p>Bids are persisted on each node in the network. You can use a Swagger call to check your bid has been stored on the test network. Navigate to the SmartContracts section and use <cite>/api/SmartContracts/storage</cite>. For the parameters, use the address of your deployed auction smart contract, the string “HighestBid” for the StorageKey, and Ulong for the DataType. A value of 10 should be returned.</p>
</div>
</div>


           </div>
           
          </div>
          
        </div>
      </div>
      <footer>
  <div class="footer-pagination">
    
      <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        
          <a href="auction-smart-contract.html" class="btn btn-primary float-right" title="The Auction Smart Contract" accesskey="n" rel="next">Next <span class="fa fa-arrow-right"></span></a>
        
        
          <a href="uses-of-smart-contracts.html" class="btn btn-neutral" title="Uses of Smart Contracts" accesskey="p" rel="prev"><span class="fa fa-arrow-left"></span> Previous</a>
        
      </div>
    
  </div>

  <div role="contentinfo" class="footer-copyright">
    <div class="footer-logo-copyright">
      <img src="../_static/img/footer-logo.png" alt="Stratis" class="footer-logo">
      <p>
          &copy; Copyright 2018, Stratis Platform.

      </p>
    </div>

    <div class="footer-links">
      <a class="footer-social-link" href="https://twitter.com/stratisplatform"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      <a class="footer-social-link" href="https://github.com/stratisproject"><i class="fa fa-github-alt" aria-hidden="true"></i></a>

      <p class="footer-legal-links">
        <a href="">Terms &amp; Conditions</a>
        <a href="">Privacy Policy</a>
      </p>
    </div>

    <div style="clear: both;"></div>
  </div> 

</footer>

    </section>
    
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>